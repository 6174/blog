#本科生毕业论文
---

题目：面向Web前端的BDD/TDD测试工具开发
院系：软件学院
专业：软件工程（计算机应用软件）
学号：10389054
指导老师：王青（助理教授） 

##摘要
---
**关键词**： `测试驱动开发`， `UnitX`， `前端测试`， `测试工具`

##目录  TAG-
* 第一章 前言
    - 1.1 背景意义
    - 1.2 研究开发现状
    - 1.3 项目目标
    - 1.4 论文结构
* 第二章 技术与原理
    - 2.1 概述
    - 2.2 技术工具
        + nodejs
        + node-webkit 
        + selenium
        + phantomJs
        + 其他
    - 2.3 原理与设计
    - 2.4 技术实现难点
* 第三章 需求建模
    - 概述
    - 需求分析
    - 用例分析
    - 领域模型
* 第四章 架构设计 
    - 概述
    - 主体架构
    - 活动图
        + 测试流程
        + 活动图分析
    - 时序图
    - 设计模式
    - 架构设计优缺点
* 第五章 模块设计
    - 概述
    - 主要模块设计 
        + server
            * selenium server
            * socket server
        + ui模块
        + project 模块
        + webdriver模块
        + 测试框架adapter模块
        + slave
            * injector模块
            * simulate 精灵模块
* 第六章 部署与应用
    - 安装
    - 效果
    - todo-list开发例子
* 第七章 总结与展望
    - 总结
    - 展望
* 致谢........................................................
* 参考文献....................................................
* 附录 .......................................................
* 原创性声明 .................................................


##第一章 前言
---
### 1.1 项目背景和意义
* 从web1.0时代到web2.0时代再到现在的web app时代，web技术的发展让人瞠目结舌。而Web前端作为web app的重要组成部分， 其相应的技术得到了前所未有的提升。web前端开发的技术变得越来越复杂：前端模块化，MV*模式，前端脚本预处理，脚手架工具，web component。这就意味着前端开发的难度和复杂度的提升。前端代码不再是以前的javascript代码片段，而是变得有组织，模块化， 结构化的工程性的庞大的代码仓库。庞大的代码以为着代码的可维护性变低，代码质量越来越糟糕，开发变得缓慢。 

* 解决这些问题的一个有效方法是使用测试驱动开发，这种方法已经被应用到大多数项目开发当中，是敏捷开发遵从的方法， 在各大语言当中都有相应的UnitX实现，如java，python，php有对应的junit，PyUnit，PHPUnit。对于javascript，有如下框架：jasmine，mocha，chai等等。这些项目已经被应用于很多的大型前端应用开发当中。 

* 但事实上国内如阿里，腾讯甚至facebook等大型互联网公司并没有在前端业务开发中应用测试驱动开发。前端开发和其他项目的开发有许多的不同点。其一：对于大型网站来说，前端代码的更新速度相比其他项目更快，需要做快速的代码变更和迭代；其二：前端的代码大多是交互和逻辑在一起，并且很多数据需要异步请求，与传统的单元测试很大不同；其三：测试开发成本更高，为了完成测试，需要做很多额外的事情，并在开发过程中不断的在测试环境和线上环境做代码切换；这些问题使得测试驱动开发很难应用到前端业务代码当中。而以上提到的js测试框架如chai， jasmine大多应用在核心逻辑代码，框架代码或者nodejs项目中。

* 为了解决上面所说的问题，最简单的方法就是通过工具来简化前端测试的步骤，而本文的目的就是旨在设计一个前端开发工具，做前端测试过程的管理和简化，以及解决前端开发过程中的交互异步问题。

### 1.2 研究开发现状分析
* 在前端测试工具领域，开源界已经做了很多的尝试，并且已经有了很多不错的成果。有如testem，karma，totora。这些工具已经极大的简化了前端测试过程中的测试复杂问题，并且它们都有一定的共性：
```
    1. 通过命令行来做测试的启动以及测试的报告输出；
    2. 在真实浏览器当中运行；
    3. 运行过程都是启动一个runner页面；
```  

* runner页面与需要测试的web app所在的应用地址无关，这就意味着在做测试之前需要配置或者加入应用的代码才能执行测试脚本。而这一过程会提高测试的成本。runner页面另外一个缺点是无法简单的配合webapp中的dom结构做测试，并且测试过程中由于runner在不同的域，会存在真实环境中不存在的跨域问题。而本文所做的工具不同的是，直接在webapp中注入测试脚本，无需引入应用代码，在完全真实的环境下运行测试。

* 另外虽然基于命令行的测试工具对程序员来说简单直接，但当测试报告变多，很难在命令行中查找并做错误分析，并且命令行模式下很难完成交互动作。而本文所做工具利用node-webkit实现，基于桌面应用提供更好的数据展现效果。

### 1.3 项目的目标和范围
* 项目的目标：基于node-webkit和selenium开发一个前端测试工具。通过这个工具简化前端测试过程的复杂度，让用户只需要关注编写测试脚本。 这个工具有以下几个功能:
```
    * 1. 使用jasmine编写测试specs；
    * 2. 界面化和可配置的测试过程管理；
    * 3. 提供交互异步解决方案；
```

### 1.4 论文结构介绍

这篇论文分为七个章节：
* 第一章：前言， 说明项目的背景和开发意义，简洁现有的前端测试工具并分析了其优势劣势，概述本项目的目标和范围。
* 第二章：技术与原理，介绍该项目中所用到的技术以及如何应用这些技术组合实现本项目中的测试工具。
* 第三章：需求建模，说明本项目的需求，以及细化的讲解本项目所实现的功能，功能的可用性以及受到的限制。
* 第四章：架构设计，说明本项目的代码工程结构以及所用到的设计模式和方法。
* 第五章：模块设计，细化的说明项目工程代码中的具体模块的功能和实现。
* 第六章：部署和应用，说明本工具的安装部署流程，以及通过本工具实现一个todo-list实例。
* 第七章：总结 


## 第二章 技术与原理
---

### 2.1 概述
* 这个章节主要描述本项目所用到的技术细节，node.js，node-webkit，selenium，wd.js，jasmine，socket.io，backbone，bootstrap，less。以及利用这些技术实现测试的基本原理。还会介绍本项目中实现的技术难点。

### 2.2 技术与工具
* **2.2.1 node.js**
    - node.js 是一个基于Chrome-JavaScript运行时建立的一个平台，用来方便地搭建快速的，易于扩展的网络应用· Node.js 借助事件驱动，非阻塞 I/O 模型变得轻量和高效，非常适合 run across distributed devices 的 data-intensive 的实时应用.
    - node.js在短短的几年间发展迅速。 因为node.js与前端使用统一的语言，nodejs逐渐成为了前端工程师必备的基本技能。并且前端相关的很多工具也都是通过node平台代价，比如前端的构建工具grunt，gulp，前端的mock工具平台，js静态分析等。这也是在1.2节提到的现有前端工具都是通过node平台搭建的原因。
* **2.2.2 node-webkit**
    - node-webkit 是一个基于 Chromium 和 Node.js 的 Web 运行环境，可让直接在 DOM 中调用 Node.js 模块，并可使用任何现有的 Web 技术来编写本地应用。
    - node-webkit 将chromium和node.js的事件循环绑定在一起，所以在应用代码中既可以使用npm中的所有模块也可以使用chromium中支持的css3，html5 API。这种优势极大的简化了桌面应用的开发流程。目前国内已经有了很多项目是使用node-webkit构建，未来node-webkit更有可能发展到移动端的Native App开发。
* **2.2.3 selenium**
    - Selenium 是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。支持的浏览器包括IE(7、8、9)、Mozilla Firefox、Mozilla Suite等。 
    - selenium 是目前而言做ATDD测试的首要选择，本项目中就是利用selenium来实现对浏览器操作的管理。
* **2.2.4 wd.js**
    - wd.js 是基于node.js的selenium2 webdriver。通过webdriver简化了selenium的操作，可以很容易的实例化一个broswer对象。并通过此对象来实现对浏览器的实际操作。wd.js的提供了基于promise模型的syntactic sugar。更是简化了webdriver的异步操作。 
* **2.2.5 jasmine**
    - Jasmine 是一个前端javascript BDD测试框架。不依赖与任何第三方库，不依赖与DOM。可以在Nodejs环境和浏览器环境中运行。提过简洁易用的API，让前端测试代码过程变得极其简单直观。
    - 目前本项目使用Jasmine作为测试默认框架，未来会提供mocha，Qunit，chai等测试框架的兼容。
* **2.2.6 socket.io**
    - Socket.IO旨在让各种浏览器与移动设备上实现实时app功能，模糊化各种传输机制。目前基于node.js 的实时应用如群聊，多人在线游戏都是通过socket.io实现。
    - 本项目中使用socket.io实现测试结果在浏览器和应用中同步。
* **2.2.7 backbone**
    - Backbone是一个前端MVC框架，提供构建web app基本的架构。包括带有key-value以及自定义事件绑定的model类。带有丰富API的collections类。声明式 定义事件绑定的view类。Backbone以及在很多大型web应用中得到应用。
    - 本项目中的客户端UI开发是基于backbone的MVC模式开发。
* **2.2.8 bootstrap**
    - Bootstrap是Twitter推出的一个开源的用于前端开发的工具包。它由Twitter的设计师Mark Otto和Jacob Thornton合作开发，是一个CSS/HTML框架。Bootstrap提供了优雅的HTML和CSS规范，它即是由动态CSS语言Less写成。Bootstrap一经推出后颇受欢迎，一直是GitHub上的热门开源项目，包括NASA的MSNBC（微软全国广播公司）的Breaking News都使用了该项目。
* **2.2.9 Less**
    - LESS 是动态的样式表语言，通过简洁明了的语法定义，使编写 CSS 的工作变得非常简单。由上面的bootstrap简介可知，bootstrap的样式是使用LESS所写，可见Less已经在前端开发中占有一定的份量。
    - 本项目为了简化样式的编写，亦是通过less来编写样式表

### 2.3 原理与设计
### 2.4 技术实现难点





















